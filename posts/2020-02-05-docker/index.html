<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Getting Started with Docker | mzfr's blog</title><meta name=keywords content><meta name=description content="What are Docker containers? Docker containers are a smaller version of Virtual Machines with farless overheads and lot for flexibility. If you want to isolate different services on your system then you can make multiple dockers images for each service and run them, separately.
How it works? Well all you need to do is make a file named Dockerfile which would contain the rules/instructions of what all has to be done in that container and then you start the build of your container."><meta name=author content><link rel=canonical href=https://blog.mzfr.me/posts/2020-02-05-docker/><link crossorigin=anonymous href=/assets/css/stylesheet.eada69fd0a09c054310631fda560c45364d1f38af1bab53623c2f4013a9119d2.css integrity="sha256-6tpp/QoJwFQxBjH9pWDEU2TR84rxurU2I8L0ATqRGdI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.mzfr.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.mzfr.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.mzfr.me/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.mzfr.me/apple-touch-icon.png><link rel=mask-icon href=https://blog.mzfr.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src=https://analytics.mzfr.me/script.js data-website-id=10e5d04b-13bb-4110-99b2-8c72f8854043></script><meta property="og:title" content="Getting Started with Docker"><meta property="og:description" content="What are Docker containers? Docker containers are a smaller version of Virtual Machines with farless overheads and lot for flexibility. If you want to isolate different services on your system then you can make multiple dockers images for each service and run them, separately.
How it works? Well all you need to do is make a file named Dockerfile which would contain the rules/instructions of what all has to be done in that container and then you start the build of your container."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.mzfr.me/posts/2020-02-05-docker/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-05T00:00:00+00:00"><meta property="article:modified_time" content="2020-02-05T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Getting Started with Docker"><meta name=twitter:description content="What are Docker containers? Docker containers are a smaller version of Virtual Machines with farless overheads and lot for flexibility. If you want to isolate different services on your system then you can make multiple dockers images for each service and run them, separately.
How it works? Well all you need to do is make a file named Dockerfile which would contain the rules/instructions of what all has to be done in that container and then you start the build of your container."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://blog.mzfr.me/posts/"},{"@type":"ListItem","position":3,"name":"Getting Started with Docker","item":"https://blog.mzfr.me/posts/2020-02-05-docker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Getting Started with Docker","name":"Getting Started with Docker","description":"What are Docker containers? Docker containers are a smaller version of Virtual Machines with farless overheads and lot for flexibility. If you want to isolate different services on your system then you can make multiple dockers images for each service and run them, separately.\nHow it works? Well all you need to do is make a file named Dockerfile which would contain the rules/instructions of what all has to be done in that container and then you start the build of your container.","keywords":[],"articleBody":"What are Docker containers? Docker containers are a smaller version of Virtual Machines with farless overheads and lot for flexibility. If you want to isolate different services on your system then you can make multiple dockers images for each service and run them, separately.\nHow it works? Well all you need to do is make a file named Dockerfile which would contain the rules/instructions of what all has to be done in that container and then you start the build of your container.\nWe’ll learn how to write Dockerfile shortly but before that let us dicuss some commands that are used to start/stop/build docker image.\nInstallation Just install docker using the package manager of your OS and then start the docker.service(if not already running.)\nTo start the docker.service systemctl start docker.service General Commands for docker When you are in a directory containing Dockerfile run docker build . This will build your Docker image.\nTo check all the existing docker images run docker images To see all the docker process: docker ps -a This will show you all the running and exited docker process.\nTo stop the container: docker stop To kill a process: docker kill To remove the docker process docker rm Note: Make sure to kill the process before you try to remove it.\nTo remove the docker image docker rmi Note: Make sure that you’ve removed the process that was using that image.\nTo commit changes to the container: docker commit This is for when you make changes to some image you might have pulled from dockerhub and then would like to save those changes to a new image.\nThese are the most commonly used docker commands. Obviously there are lot of other commands which you can read about either by running man docker or docker --help\nCreating Dockerfile Knowing all the docker command might not be enough to be able to play with this weirdly awesome technology. One of the important thing in docker is Dockerfile which contains all instructions that will be followed in order to build the container.\nHere are the most commonly used Dockerfile instructions:\nFROM: This is the first non-comment instruction in the Dockerfile. Usually the syntax is FROM :. So if we want to make an image for ubuntu 16.04 we’ll write FROM ubuntu:16.04. If we are going to do just FROM ubuntu then it would take the latest version of ubuntu to build the image.\nENV: This is used in the dockerfile to set any environment variable.\n`ENV user=root` Here we are making an environment variable named user with value root so then later in the Dockerfile we can use $user to refer to the user root.\nRUN: This command is used, obviously to run any command you want. We can also run a script using the RUN command. The format to run a script is RUN [\"\", \"\", \"\"] (exec form). `Run mkdir /home/mzfr`. COPY: Using this instruction you can copy any file from your local system to docker image. Say you have a script name hack.py in your /tmp folder and what that to be present in /home/mzfr/ in your docker image so you can write the following in the docker image COPY /tmp/hack.py /home/mzfr/hack.py Expose: This informs Docker that the container listens on the specified network port(s) at runtime. EXPOSE 22 ADD: Add is very similar to COPY the only difference is that in ADD instruction also supports remote file URL.\nWORKDIR: This sets the working directory for any RUN, CMD, ENTRYPOINT, COPY, and ADD instructions that follows it.\nUSER: This instruction sets the user name to use when running the image and for any RUN, CMD instructions that follow it in the Dockerfile.\nUSER root RUN whoami This will give root as the output because before running whoami you set user as root. We can also say that this let us execute commands as different users.\nThese are almost 90-95% of the command that I’ve ever used in writing my Dockerfiles.\nExamples Now we’ll see some examples of Dockerfile so you’ll have a better idea of what is happening and how it’s done.\nExample 1\n# ubuntu 16.04 docker image FROM ubuntu:16.04 # set environment variable \"user\" with value \"hacker\" ENV user=hacker # get updates RUN apt-get update # install openssh RUN apt-get install -y openssh-server # install lshell RUN apt-get install -y lshell # Make a directory RUN mkdir /var/run/sshd # add a new user named \"hacker\" RUN useradd -m $user # copy a file from CWD to the specified docker directory COPY ./hack.py /home/$user/hack.py RUN chmod +x /home/$user/me/hack.py RUN chown -R root:$user /home/$user RUN chmod -R 750 /home/$user RUN chsh -s /usr/bin/lshell hacker RUN echo \"hacker:passwd\" | chpasswd COPY ./lshell.conf /etc/lshell.conf # Expose port 22 so when docker run it is accesible on 22 EXPOSE 22 # Run a SSH daemon with -D arg CMD [\"/usr/sbin/sshd\", \"-D\"] Example 2\nFROM python:3 # update. upgrade. Install xinetd RUN apt-get update --fix-missing \u0026\u0026 apt-get install -y xinetd # Add a new user group and a new user to that group RUN groupadd -r ctf \u0026\u0026 useradd -r -g ctf ctf # Set the working directory for the next commands WORKDIR /usr/src/app # Copy the content of src folder from file system to docker /usr/src/app COPY ./src . RUN pip install --no-cache-dir -r requirements.txt # Configuration files/scripts ADD config/ctf.xinetd /etc/xinetd.d/ctf ADD config/run_xinetd.sh /etc/run_xinetd.sh ADD config/run_challenge.sh /run_challenge.sh RUN chmod +x /run_challenge.sh RUN chmod +x /etc/run_xinetd.sh #start the xinetd service RUN service xinetd restart That’s all for now, hope this will help you in understanding Docker.\nThanks for reading, feedback is always appreciated.\nYou can follow me on @0xmzfr.\n","wordCount":"944","inLanguage":"en","datePublished":"2020-02-05T00:00:00Z","dateModified":"2020-02-05T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.mzfr.me/posts/2020-02-05-docker/"},"publisher":{"@type":"Organization","name":"mzfr's blog","logo":{"@type":"ImageObject","url":"https://blog.mzfr.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.mzfr.me accesskey=h title="mzfr's blog (Alt + H)">mzfr's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.mzfr.me/ title=Home><span>Home</span></a></li><li><a href=https://blog.mzfr.me/about/ title=About><span>About</span></a></li><li><a href=https://wiki.mzfr.me title=Notes><span>Notes</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://blog.mzfr.me/ctf/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Getting Started with Docker</h1><div class=post-meta><span title='2020-02-05 00:00:00 +0000 UTC'>February 5, 2020</span>&nbsp;·&nbsp;5 min</div></header><div class=post-content><h4 id=what-are-docker-containers>What are Docker containers?<a hidden class=anchor aria-hidden=true href=#what-are-docker-containers>#</a></h4><p>Docker containers are a smaller version of Virtual Machines with farless overheads and lot for flexibility. If you want to isolate different services on your system then you can make multiple dockers images for each service and run them, separately.</p><h4 id=how-it-works>How it works?<a hidden class=anchor aria-hidden=true href=#how-it-works>#</a></h4><p>Well all you need to do is make a file named <code>Dockerfile</code> which would contain the rules/instructions of what all has to be done in that container and then you start the build of your container.</p><p>We&rsquo;ll learn how to write Dockerfile shortly but before that let us dicuss some commands that are used to start/stop/build docker image.</p><h4 id=installation>Installation<a hidden class=anchor aria-hidden=true href=#installation>#</a></h4><p>Just install <code>docker</code> using the package manager of your OS and then start the <code>docker.service</code>(if not already running.)</p><ul><li>To start the <code>docker.service</code></li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>systemctl start docker.service
</span></span></code></pre></div><h4 id=general-commands-for-docker>General Commands for docker<a hidden class=anchor aria-hidden=true href=#general-commands-for-docker>#</a></h4><ul><li>When you are in a directory containing <code>Dockerfile</code> run</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker build .
</span></span></code></pre></div><p>This will build your Docker image.</p><ul><li>To check all the existing docker images run</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker images
</span></span></code></pre></div><ul><li>To see all the docker process:</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker ps -a
</span></span></code></pre></div><p>This will show you all the running and exited docker process.</p><ul><li>To stop the container:</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker stop &lt;container-id&gt;
</span></span></code></pre></div><ul><li>To <code>kill</code> a process:</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker <span style=color:#ef8383>kill</span> &lt;name-of-the-process&gt;
</span></span></code></pre></div><ul><li>To remove the docker process</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker rm &lt;name-of-the-process&gt;
</span></span></code></pre></div><p><strong>Note</strong>: Make sure to kill the process before you try to remove it.</p><ul><li>To remove the docker <code>image</code></li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker rmi &lt;image-id&gt;
</span></span></code></pre></div><p><strong>Note</strong>: Make sure that you&rsquo;ve removed the process that was using that image.</p><ul><li>To commit changes to the container:</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker commit &lt;container_id&gt;
</span></span></code></pre></div><p>This is for when you make changes to some image you might have pulled from dockerhub and then would like to save those changes to a new image.</p><p>These are the most commonly used docker commands. Obviously there are lot of other commands which you can read about either by running <code>man docker</code> or <code>docker --help</code></p><h2 id=creating-dockerfile>Creating Dockerfile<a hidden class=anchor aria-hidden=true href=#creating-dockerfile>#</a></h2><p>Knowing all the docker command might not be enough to be able to play with this weirdly awesome technology. One of the important thing in docker is <code>Dockerfile</code> which contains all <code>instructions</code> that will be followed in order to build the container.</p><p>Here are the most commonly used Dockerfile instructions:</p><ul><li><p><strong>FROM</strong>: This is the first non-comment instruction in the Dockerfile. Usually the syntax is <code>FROM &lt;images>:&lt;tag></code>. So if we want to make an image for ubuntu 16.04 we&rsquo;ll write <code>FROM ubuntu:16.04</code>. If we are going to do just <code>FROM ubuntu</code> then it would take the latest version of ubuntu to build the image.</p></li><li><p><strong>ENV</strong>: This is used in the dockerfile to set any environment variable.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>`ENV user=root`
</span></span></code></pre></div><p>Here we are making an <code>environment variable</code> named <code>user</code> with value <code>root</code> so then later in the Dockerfile we can use <code>$user</code> to refer to the user <code>root</code>.</p><ul><li><strong>RUN</strong>: This command is used, obviously to <code>run</code> any command you want. We can also run a script using the RUN command. The format to run a script is
<code>RUN ["&lt;executable>", "&lt;param1>", "&lt;param2>"] (exec form)</code>.</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>`Run mkdir /home/mzfr`.
</span></span></code></pre></div><ul><li><strong>COPY</strong>: Using this instruction you can copy any file from your local system to docker image. Say you have a script name <code>hack.py</code> in your <code>/tmp</code> folder and what that to be present in <code>/home/mzfr/</code> in your docker image so you can write the following in the docker image</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>COPY /tmp/hack.py /home/mzfr/hack.py
</span></span></code></pre></div><ul><li><strong>Expose</strong>: This informs Docker that the container listens on the specified network port(s) at runtime.</li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>EXPOSE 22
</span></span></code></pre></div><ul><li><p><strong>ADD</strong>: Add is very similar to <code>COPY</code> the only difference is that in <code>ADD</code> instruction also supports <code>remote file URL</code>.</p></li><li><p><strong>WORKDIR</strong>: This sets the working directory for any <code>RUN</code>, <code>CMD</code>, <code>ENTRYPOINT</code>, <code>COPY</code>, and <code>ADD</code> instructions that follows it.</p></li><li><p><strong>USER</strong>: This instruction sets the user name to use when running the image and for any <code>RUN</code>, <code>CMD</code> instructions that follow it in the Dockerfile.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>USER root
</span></span><span style=display:flex><span>RUN whoami
</span></span></code></pre></div><p>This will give <code>root</code> as the output because before running <code>whoami</code> you set <code>user</code> as <code>root</code>. We can also say that this let us execute commands as different users.</p><p>These are almost 90-95% of the command that I&rsquo;ve ever used in writing my Dockerfiles.</p><h3 id=examples>Examples<a hidden class=anchor aria-hidden=true href=#examples>#</a></h3><p>Now we&rsquo;ll see some examples of <code>Dockerfile</code> so you&rsquo;ll have a better idea of what is happening and how it&rsquo;s done.</p><p><strong>Example 1</strong></p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># ubuntu 16.04 docker image</span>
</span></span><span style=display:flex><span><span style=color:#98c379>FROM ubuntu:16.04</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># set environment variable &#34;user&#34; with value &#34;hacker&#34;</span>
</span></span><span style=display:flex><span><span style=color:#98c379>ENV user=hacker</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># get updates</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN apt-get update</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># install openssh</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN apt-get install -y openssh-server</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># install lshell</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN apt-get install -y lshell</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># Make a directory</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN mkdir /var/run/sshd</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># add a new user named &#34;hacker&#34;</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN useradd -m $user</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># copy a file from CWD to the specified docker directory</span>
</span></span><span style=display:flex><span><span style=color:#98c379>COPY ./hack.py /home/$user/hack.py</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN chmod +x /home/$user/me/hack.py</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN chown -R root:$user /home/$user</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN chmod -R 750 /home/$user</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN chsh -s /usr/bin/lshell hacker</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN echo &#34;hacker:passwd&#34; | chpasswd</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#98c379>COPY ./lshell.conf /etc/lshell.conf</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># Expose port 22 so when docker run it is accesible on 22</span>
</span></span><span style=display:flex><span><span style=color:#98c379>EXPOSE 22</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># Run a SSH daemon with -D arg</span>
</span></span><span style=display:flex><span><span style=color:#98c379>CMD [&#34;/usr/sbin/sshd&#34;, &#34;-D&#34;]</span>
</span></span></code></pre></div><p><strong>Example 2</strong></p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#98c379>FROM python:3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># update. upgrade. Install xinetd</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN apt-get update --fix-missing &amp;&amp; apt-get install -y xinetd</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># Add a new user group and a new user to that group</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN groupadd -r ctf &amp;&amp; useradd -r -g ctf ctf</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># Set the working directory for the next commands</span>
</span></span><span style=display:flex><span><span style=color:#98c379>WORKDIR /usr/src/app</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># Copy the content of src folder from file system to docker /usr/src/app</span>
</span></span><span style=display:flex><span><span style=color:#98c379>COPY ./src .</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN pip install --no-cache-dir -r requirements.txt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># Configuration files/scripts</span>
</span></span><span style=display:flex><span><span style=color:#98c379>ADD config/ctf.xinetd /etc/xinetd.d/ctf</span>
</span></span><span style=display:flex><span><span style=color:#98c379>ADD config/run_xinetd.sh /etc/run_xinetd.sh</span>
</span></span><span style=display:flex><span><span style=color:#98c379>ADD config/run_challenge.sh /run_challenge.sh</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN chmod +x /run_challenge.sh</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN chmod +x /etc/run_xinetd.sh</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic>#start the xinetd service</span>
</span></span><span style=display:flex><span><span style=color:#98c379>RUN service xinetd restart</span>
</span></span></code></pre></div><hr><p>That&rsquo;s all for now, hope this will help you in understanding Docker.</p><p>Thanks for reading, feedback is always appreciated.</p><p>You can follow me on <a href=https://twitter.com/0xmzfr>@0xmzfr</a>.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://blog.mzfr.me/posts/2020-04-18-autopsy-cert/><span class=title>« Prev</span><br><span>Review of Autopsy online training</span></a>
<a class=next href=https://blog.mzfr.me/posts/2020-02-1-linux-priv-esc/><span class=title>Next »</span><br><span>Linux Privilege escalation</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.mzfr.me>mzfr's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>